---
layout: post
title: "[ì‚¬ì „ìº í”„ 9ì¼ì°¨] TIL 9ì¼ì°¨"
date: 2025-01-23 17:51:00 +0900
category: bootcamp-til
---

## ğŸ“– ì˜¤ëŠ˜ í•™ìŠµ
### SQL ê°•ì˜ 4ì£¼ì°¨ - 5 ~ 5ì£¼ì°¨

<!-- #### ğŸ“ƒ  -->

---

#### - JOIN
- **INNER JOIN** : ë‘ í…Œì´ë¸”ì—ì„œ ê³µí†µëœ ê°’ì´ ìˆëŠ” í–‰ë§Œ ë°˜í™˜, ë§¤ì¹­ë˜ì§€ ì•ŠëŠ” ë°ì´í„°ëŠ” ì œì™¸  
**INNER JOIN** ì—ì„œ 'INNER' ì€ ìƒëµ ê°€ëŠ¥
- **LEFT JOIN** : ì²« ë²ˆì§¸ í…Œì´ë¸”ì˜ ëª¨ë“  ë°ì´í„°ë¥¼ ë°˜í™˜, ë‘ ë²ˆì§¸ í…Œì´ë¸”ê³¼ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ë°ì´í„°ëŠ” NULLë¡œ í‘œì‹œ
- **RIGHT JOIN** : ë‘ ë²ˆì§¸ í…Œì´ë¸”ì˜ ëª¨ë“  ë°ì´í„°ë¥¼ ë°˜í™˜, ì²« ë²ˆì§¸ í…Œì´ë¸”ê³¼ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ë°ì´í„°ëŠ” NULLë¡œ í‘œì‹œ
- **FULL OUTER JOIN** : ë‘ í…Œì´ë¸”ì˜ ëª¨ë“  ë°ì´í„°ë¥¼ ë°˜í™˜, ë§¤ì¹­ë˜ì§€ ì•ŠëŠ” ë°ì´í„°ëŠ” NULLë¡œ í‘œì‹œ
- **CROSS JOIN** : ë‘ í…Œì´ë¸”ì˜ ëª¨ë“  í–‰ì˜ ì¡°í•©ì„ ë°˜í™˜ (Aí…Œì´ë¸” x Bí…Œì´ë¸”)
            
| íŠ¹ì§• | JOIN | LEFT JOIN |
|:--:|:-------------:|:----:|
| ë°˜í™˜ë˜ëŠ” ë°ì´í„° | ë‘ í…Œì´ë¸”ì—ì„œ ì¼ì¹˜í•˜ëŠ” ë°ì´í„°ë§Œ ë°˜í™˜ | ì™¼ìª½ í…Œì´ë¸”ì˜ ëª¨ë“  ë°ì´í„°ì™€ ì˜¤ë¥¸ìª½ í…Œì´ë¸”ì˜ ì¼ì¹˜í•˜ëŠ” ë°ì´í„° |
| ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ë°ì´í„°  | ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ë°ì´í„°ëŠ” ì œì™¸ | ì™¼ìª½ í…Œì´ë¸”ì˜ ë°ì´í„°ëŠ” ëª¨ë‘ í¬í•¨, ì˜¤ë¥¸ìª½ í…Œì´ë¸”ì€ NULLë¡œ ë°˜í™˜ |
| ì‚¬ìš© ì‚¬ë¡€  | ë‘ í…Œì´ë¸” ê°„ ê³µí†µëœ ë°ì´í„°ë§Œ í•„ìš”í•  ë•Œ  | ì™¼ìª½ í…Œì´ë¸”ì˜ ëª¨ë“  ë°ì´í„°ê°€ í•„ìš”í•  ë•Œ (ì¼ì¹˜í•˜ëŠ” ë°ì´í„°ê°€ ì—†ì„ ê²½ìš°ì—ë„) |

> INNER JOIN
```sql
SELECT column FROM table_name_1 t1
JOIN table_name_2 t2 ON t1.common_column = t2.common_column;
```
> LEFT JOIN
```sql
SELECT column FROM table_name_1 t1
LEFT JOIN table_name_2 t2 ON t1.common_column = t2.common_column;
```
>RIGHT JOIN
```sql
SELECT column FROM table_name_1 t1
RIGHT JOIN table_name_2 t2 ON t1.common_column = t2.common_column;
```
> FULL OUTER JOIN
```sql
SELECT column FROM table_name_1 t1
FULL OUTER JOIN table_name_2 t2 ON t1.common_column = t2.common_column;
```
> CROSS JOIN
```sql
SELECT column FROM table_name_1
CROSS JOIN table_name_2;
```

#### - ì¡°íšŒí•œ ë°ì´í„°ì— ì•„ë¬´ ê°’ì´ ì—†ë‹¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œ? 
- ì—†ëŠ” ê°’ ì œì™¸
> 
```sql
SELECT restaurant_name,
       AVG(rating) average_of_rating,
       AVG(IF(rating<>'Not given', rating, NULL)) average_of_rating2
FROM food_orders
GROUP BY 1;
```
![edu2-1](/public/img/sql-edu/edu2-1.PNG)  
> => ì˜ˆì‹œ ì½”ë“œì—ì„œ ratingì—ì„œ 'Not given'ìœ¼ë¡œ ë˜ì–´ìˆëŠ” ê°’ì„ NULL ê°’ìœ¼ë¡œ ë°”ê¿” AVG ê³„ì‚°ì—ì„œ ì œì™¸

- ë‹¤ë¥¸ ê°’ìœ¼ë¡œ ëŒ€ì²´
>
```sql
SELECT a.order_id,
       a.customer_id,
       a.restaurant_name,
       a.price,
       b.name,
       b.age,
       COALESCE(b.age, 20) "null ì œê±°",
       b.gender
FROM food_orders a 
LEFT JOIN customers b ON a.customer_id=b.customer_id
WHERE b.age IS NULL;
```
![edu2-2](/public/img/sql-edu/edu2-2.PNG)  
> => ì˜ˆì‹œ ì½”ë“œì—ì„œ b.ageì˜ ê°’ì´ NULLì¸ê²ƒì„ ì°¾ì•„ 20ìœ¼ë¡œ ëŒ€ì²´

#### - ì¡°íšŒí•œ ë°ì´í„°ê°€ ìƒì‹ì ì´ì§€ ì•Šì€ ê°’ì„ ê°€ì§€ê³  ìˆë‹¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œ?
- ë²”ìœ„ ì§€ì •í•˜ê¸°
>
```sql
SELECT customer_id, name, email, gender, age,
       CASE WHEN age<15 THEN 15
            WHEN age>80 THEN 80
            ELSE age END "ë²”ìœ„ë¥¼ ì§€ì •í•´ì¤€ age"
FROM customers;
```
![edu2-3](/public/img/sql-edu/edu2-3.PNG)  
> => 15ì„¸ ë¯¸ë§Œì€ 15ë¡œ 80ì„¸ ì´ˆê³¼ëŠ” 80ìœ¼ë¡œ ë²”ìœ„ ì§€ì •

#### - Pivot Table
- 2ê°œ ì´ìƒì˜ ê¸°ì¤€ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì§‘ê³„í•  ë•Œ, ë³´ê¸° ì‰½ê²Œ ë°°ì—´í•˜ì—¬ ë³´ì—¬ì£¼ëŠ” ê²ƒ
- Pivot Tableì„ ë§Œë“¤ ë•ŒëŠ” ì—¬ëŸ¬ í–‰ì„ í•˜ë‚˜ì˜ í–‰ìœ¼ë¡œ í•©ì¹˜ê¸° ìœ„í•´ ì§‘ê³„ í•¨ìˆ˜ì¸ MAX, SUM, COUNT, AVG ë“±ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì 
>
```sql
SELECT age,
       MAX(if(gender='male', order_count, 0)) male,
       MAX(if(gender='female', order_count, 0)) female
FROM 
(
SELECT b.gender,
       CASE WHEN age BETWEEN 10 AND 19 THEN 10
            WHEN age BETWEEN 20 AND 29 THEN 20
            WHEN age BETWEEN 30 AND 39 THEN 30
            WHEN age BETWEEN 40 AND 49 THEN 40
            WHEN age BETWEEN 50 AND 59 THEN 50 END age,
       count(1) order_count
FROM food_orders a INNER JOIN customers b ON a.customer_id=b.customer_id
WHERE b.age BETWEEN 10 AND 59
GROUP BY 1, 2
) t
GROUP BY 1
ORDER BY 1 DESC
```
![edu2-4](/public/img/sql-edu/edu2-4.PNG)  
> FROM ì•ˆì— ìˆëŠ” SELECT ë¬¸ë§Œ ì‹¤í–‰í•˜ê²Œ ë˜ë©´ ìœ„ì˜ ê²°ê³¼ ê°’ì´ ë‚˜ì˜¤ê²Œ ëœë‹¤  
![edu2-5](/public/img/sql-edu/edu2-5.PNG)  
> í•˜ì§€ë§Œ MAXì™€ ê°™ì€ ì§‘ê³„í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ í•˜ë‚˜ì˜ í–‰ìœ¼ë¡œ í•©ì³ì£¼ë©´ ìœ„ì˜ ê²°ê³¼ ê°’ì´ ë‚˜ì˜¤ê²Œ ëœë‹¤

#### - Window Function
- ë°ì´í„°ë¥¼ ê·¸ë£¹í™” ì—†ì´ë„ íŠ¹ì • ë²”ìœ„ì— ëŒ€í•´ ì§‘ê³„, ìˆœìœ„, ëˆ„ì  ê³„ì‚° ë“±ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” í•¨ìˆ˜
>
```sql
SELECT window_function(argument) OVER (PARTITION BY column ORDER BY column [ROWS / RANGE](ë‘˜ì¤‘ í•˜ë‚˜ ì‚¬ìš©) clause)
FROM table_name;
```
> window_function : ê¸°ëŠ¥ ëª…  
argument : í•¨ìˆ˜ì— ë”°ë¼ ì‘ì„±í•˜ê±°ë‚˜ ìƒëµ   
PARTITION BY : ê°’ì„ ê·¸ë£¹í™”í•˜ëŠ” ê¸°ì¤€  
ORDER BY : ê°’ì„ ì •ë ¬í•˜ëŠ” ê¸°ì¤€  
ROWS or RANGE : ìœˆë„ìš°ì˜ ë²”ìœ„ ì„¤ì •

1. ìˆœìœ„ í•¨ìˆ˜
    - ROW_NUMBER() : ê° í–‰ì— ëŒ€í•´ ê³ ìœ í•œ ìˆœìœ„ë¥¼ ë¶€ì—¬, ë™ì¼í•œ ê°’ì´ ìˆì–´ë„ ìˆœìœ„ê°€ ì¤‘ë³µë˜ì§€ ì•ŠìŒ
    - RANK() : ìˆœìœ„ë¥¼ ë§¤ê¸°ì§€ë§Œ, ë™ì¼í•œ ê°’ì— ëŒ€í•´ ê³µë™ ìˆœìœ„ë¥¼ ë¶€ì—¬í•˜ë©°, ë‹¤ìŒ ìˆœìœ„ëŠ” ê±´ë„ˆëœ€
    - DENSE_RANK() : ê³µë™ ìˆœìœ„ë¥¼ ë¶€ì—¬, ë‹¤ìŒ ìˆœìœ„ë¥¼ ê±´ë„ˆë›°ì§€ ì•ŠìŒ
    - NTILE(n) : ë°ì´í„°ë¥¼ nê°œì˜ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ„ê³ , ê° í–‰ì— ê·¸ë£¹ ë²ˆí˜¸ë¥¼ ë¶€ì—¬

2. ì§‘ê³„ í•¨ìˆ˜
    - SUM() : í•©ê³„ë¥¼ ê³„ì‚°
    - AVG() : í‰ê· ê°’ì„ ê³„ì‚°
    - MAX(), MIN() : ìµœëŒ€ê°’ê³¼ ìµœì†Œê°’ ê³„ì‚°
    - COUNT() : í–‰ì˜ ê°œìˆ˜ë¥¼ ê³„ì‚°

3. ê°’ ê´€ë ¨ í•¨ìˆ˜
    - LAG() : í˜„ì¬ í–‰ì˜ ì´ì „ ê°’ì„ ë°˜í™˜
    - LEAD() : í˜„ì¬ í–‰ì˜ ë‹¤ìŒ ê°’ì„ ë°˜í™˜
    - FIRST_VALUE() : ìœˆë„ìš°ì—ì„œ ì²« ë²ˆì§¸ ê°’ì„ ë°˜í™˜
    - LAST_VALUE() : ìœˆë„ìš°ì—ì„œ ë§ˆì§€ë§‰ ê°’ì„ ë°˜í™˜
    - NTH_VALUE() : ìœˆë„ìš°ì—ì„œ në²ˆì§¸ ê°’ì„ ë°˜í™˜

4. ëˆ„ì  ë° ì´ë™ í•¨ìˆ˜
    - CUME_DIST() : ê° í–‰ì˜ ëˆ„ì  ë°±ë¶„ìœ¨(ëˆ„ì  ë¶„í¬)ë¥¼ ë°˜í™˜
    - PERCENT_RANK() : ê° í–‰ì˜ ë°±ë¶„ìœ„ ìˆœìœ„ë¥¼ ë°˜í™˜
    - SUM() : ëˆ„ì  í•©ê³„ë¥¼ ê³„ì‚°
    - AVG() : ì´ë™ í‰ê· ì„ ê³„ì‚°

#### - ë‚ ì§œ í¬ë§· í•¨ìˆ˜
- **DATE_FORMAT** : ë¬¸ìì—´ í˜•ì‹ìœ¼ë¡œ ë°˜í™˜, í˜•ì‹ì„ ì»¤ìŠ¤í„°ë§ˆì´ì¦ˆ ê°€ëŠ¥
- **YEAR**, **MONTH**, **DAY** ë“± : ì •ìˆ˜í˜• ë°ì´í„°ë¡œ ë°˜í™˜

>
```sql
SELECT DATE(date) date_type,
    DATE_FORMAT(DATE(date), '%Y') "ë…„",
    DATE_FORMAT(DATE(date), '%y') "ë…„2",
    DATE_FORMAT(DATE(date), '%m') "ì›”",
    DATE_FORMAT(DATE(date), '%d') "ì¼",
    DATE_FORMAT(DATE(date), '%w') "ìš”ì¼",
    YEAR(date) "ë…„3",
    MONTH(date) "ì›”2",
    DAY(date) "ì¼2",
    DAYNAME(date) "ìš”ì¼2",
    DAYOFWEEK(date) "ìš”ì¼3"
FROM payments;
```
![edu2-6](/public/img/sql-edu/edu2-6.PNG)

---

## ğŸ’¬

#### ì´ë¡œì¨ SQL ê°•ì˜ëŠ” ë!
#### ë‚´ì¼ SQL ë¬¸ì œ ë‚˜ë¨¸ì§€ í’€ê³  ë‹¤ìŒì£¼ ë¶€í„´ JAVA ë‹¬ë ¤ë³´ì!
