---
layout: post
title: test
date: 2025-02-04 13:51:00 +0900
category: bootcamp-til
---

<div style="width: 100%; overflow: hidden;">
  <iframe id="myIframe" src="/web/album/index.html" width="100%" style="border:none; overflow-x: auto;"></iframe>
</div>

<script>
  // iframe 높이 조정 함수
  function resizeIframe() {
    var iframe = document.getElementById("myIframe");

    // `iframe`이 제대로 로드되었는지 확인
    if (iframe && iframe.contentWindow && iframe.contentWindow.document.body) {
      // 내부 콘텐츠의 높이를 계산하여 `iframe`의 높이를 맞춤
      iframe.style.height = iframe.contentWindow.document.body.scrollHeight + "px";
    }
  }

  // 타임스탬프 추가하여 `iframe`의 src 갱신
  function updateIframeSource() {
    var iframe = document.getElementById("myIframe");
    var src = "/web/album/index.html";  // iframe의 원래 src 경로
    
    // 타임스탬프 추가하여 캐시를 방지
    iframe.src = src + "?t=" + new Date().getTime();  // 타임스탬프를 추가하여 최신 콘텐츠 불러오기
  }

  // 페이지 로드 후 iframe의 src를 업데이트하고 높이 자동 조정
  window.addEventListener('load', function() {
    updateIframeSource();  // 타임스탬프 추가하여 iframe 로드
    resizeIframe();  // 높이 자동 조정
  });

  // 창 크기 변화 시에도 높이를 재조정
  window.addEventListener("resize", resizeIframe);

  // iframe이 로드되고 나면, 내부 내용에 대한 변경 사항을 감지
  var iframe = document.getElementById("myIframe");

  iframe.onload = function() {
    // `iframe`이 로드되면 내부 동적 콘텐츠 변경 감지 시작
    var contentDocument = iframe.contentWindow.document;
    
    // MutationObserver 사용 - iframe 내의 동적 콘텐츠 변경 감지
    var observer = new MutationObserver(function() {
      resizeIframe();
    });

    observer.observe(contentDocument.body, {
      childList: true,        // 자식 요소가 추가/삭제될 때 감지
      subtree: true,          // 자식 요소 깊은 곳까지 감지
      characterData: true,    // 텍스트 변경도 감지
    });
  };
</script>