---
layout: post
title: SQL ê°•ì˜ ìˆ™ì œ 4ì£¼ì°¨
date: 2025-01-23 15:10:00 +0900
category: bootcamp-sql-hw
---

# ğŸ“š ì‹ë‹¹ë³„ í‰ê·  ìŒì‹ ì£¼ë¬¸ ê¸ˆì•¡ê³¼ ì£¼ë¬¸ìì˜ í‰ê·  ì—°ë ¹ì„ ê¸°ë°˜ìœ¼ë¡œ Segmentation í•˜ê¸°

```sql
SELECT restaurant_name,
    CASE
        WHEN average_price > 30000 THEN 'price_group 4'
        WHEN average_price > 10000 THEN 'price_group 3'
        WHEN average_price > 5000 THEN 'price_group 2'
        ELSE 'price_group 1'
    END AS price_group,
    CASE
        WHEN average_age >= 50 THEN 'age_group 4'
        WHEN average_age >= 40 THEN 'age_group 3'
        WHEN average_age >= 30 THEN 'age_group 2'
        ELSE 'age_group 1'
    END AS age_group
FROM
    ( SELECT f.restaurant_name, AVG(f.price) AS average_price, 
    AVG(c.age) AS average_age
    FROM food_orders f
    JOIN customers c ON f.customer_id = c.customer_id
    GROUP BY f.restaurant_name 
) subquery
ORDER BY restaurant_name;
```
![hw4-1](/public/img/sql-hw/hw4-1.png)
> => ì •ë‹µì—ëŠ” average_price, average_ageëŠ” ë“¤ì–´ê°€ì§€ ì•Šì§€ë§Œ  
í™•ì¸ì„ ìœ„í•´ ì„ì‹œ ì‚¬ìš©