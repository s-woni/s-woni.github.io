---
layout: post
title: SQL ê°•ì˜ ìˆ™ì œ 5ì£¼ì°¨
date: 2025-01-23 17:00:00 +0900
category: bootcamp-sql-hw
---

# ðŸ“š ìŒì‹ íƒ€ìž…ë³„, ì—°ë ¹ë³„ ì£¼ë¬¸ê±´ìˆ˜ pivot view ë§Œë“¤ê¸°

```sql
SELECT cuisine_type,
    MAX(IF(centry_age = 10, order_count, 0)) AS "10ëŒ€",
    MAX(IF(centry_age = 20, order_count, 0)) AS "20ëŒ€",
    MAX(IF(centry_age = 30, order_count, 0)) AS "30ëŒ€",
    MAX(IF(centry_age = 40, order_count, 0)) AS "40ëŒ€",
    MAX(IF(centry_age = 50, order_count, 0)) AS "50ëŒ€"
FROM
    (
    SELECT f.cuisine_type,
        CASE
            WHEN c.age >= 50 THEN 50
            WHEN c.age >= 40 THEN 40
            WHEN c.age >= 30 THEN 30
            WHEN c.age >= 20 THEN 20
            ELSE 10
        END AS centry_age,
        COUNT(*) AS order_count
    FROM food_orders f
    JOIN customers c ON f.customer_id = c.customer_id
    WHERE c.age BETWEEN 10 AND 59
    GROUP BY f.cuisine_type, centry_age
) subquery
GROUP BY cuisine_type;
```
![hw5-1](/public/img/sql-hw/hw5-1.png)