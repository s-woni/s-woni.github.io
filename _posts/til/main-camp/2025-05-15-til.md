---
layout: post
title: "[TIL] 2025-05-15 / JPA ì‹¬í™” íŠ¸ëŸ¬ë¸” ìŠˆíŒ…"
date: 2025-05-15 12:20:00 +0900
categories: 
  - til
  - main-camp
---

* toc
{:toc}

## ğŸ“– Today I Learned
### JPA ì‹¬í™” íŠ¸ëŸ¬ë¸” ìŠˆíŒ…

<!-- <h4> ğŸ“ƒ </h4> -->

---

#### - ë¬¸ì œ 1
- ë¬¸ì œ ì •ì˜
  - ìœ ì € ì¡°íšŒ ì‹œì—ëŠ” nickname ì¡°íšŒ ê°€ëŠ¥
  - todo ìƒì„± ì‹œ responseì— nickname ê°’ì´ NULL
- ì›ì¸ ì¶”ì •
  - í† í°ì— nickname ê°’ì´ ì €ì¥ë˜ì§€ ì•ŠëŠ” ê±° ê°™ìŒ
- ì¡°ì‚¬ ë° ì‹œë„
  - `User user = userRepository.findById(authUser.getId()).orElseThrow(() -> new InvalidRequestException("User not found"));`
  - ìœ„ ì½”ë“œë¥¼ ì‚¬ìš© í•˜ì—¬ ë¬¸ì œë¥¼ í•´ê²° í•˜ì˜€ìœ¼ë‚˜ í† í°ì—ì„œ ê°€ì ¸ì˜¤ëŠ” ë°©ì‹ì´ ì•„ë‹ˆë¼ DBì— ì €ì¥ëœ ê°’ì„ ê°€ì ¸ì˜¤ëŠ” ê±°ë¼ íŒ¨ìŠ¤
- í•´ê²°
  - ê³„ì† todo ìƒì„± í•  ë•Œ ë¬¸ì œê°€ ìˆëŠ” ì¤„ ì•Œì•˜ìœ¼ë‚˜
  - ë‹¨ìˆœí•˜ê²Œ í† í°ì„ ìƒì„±í•  ë–„ ë‹‰ë„¤ì„ì„ ë„£ì–´ì£¼ì§€ ì•Šì•˜ë˜ ê²ƒ..

> í•´ê²° ì „
```java
public String createToken(Long userId, String email, UserRole userRole) {
    Date date = new Date();

    return BEARER_PREFIX +
        Jwts.builder()
                .setSubject(String.valueOf(userId))
                .claim("email", email)
                .claim("userRole", userRole)
                .setExpiration(new Date(date.getTime() + TOKEN_TIME))
                .setIssuedAt(date) // ë°œê¸‰ì¼
                .signWith(key, signatureAlgorithm) // ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜
                .compact();
}
```
> í•´ê²° í›„
```java
public String createToken(Long userId, String email, String nickname, UserRole userRole) {
    Date date = new Date();

    return BEARER_PREFIX +
        Jwts.builder()
                .setSubject(String.valueOf(userId))
                .claim("email", email)
                .claim("userRole", userRole)
                .claim("nickname", nickname)
                .setExpiration(new Date(date.getTime() + TOKEN_TIME))
                .setIssuedAt(date) // ë°œê¸‰ì¼
                .signWith(key, signatureAlgorithm) // ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜
                .compact();
}
```

<!-- --- -->

<!-- <h2> ğŸ’¬ </h2> -->

<!-- <h4>  </h4> -->
